#THMLP-JR_PENETRATION_TESTER #THMMOD-INTRODUCTION_TO_WEB_HACKING

## 1. Introduction (What is Command Injection?)
<div align="center"><br><img width=300 src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/239e76f6de5e7ebaa1dffff2d28ff36c.png"></div>

In this room, weâ€™re going to be covering the web vulnerability that isÂ command injection. Once we understand what this vulnerability is, we will then showcase its impact and the risk it imposes on an application.

Then, youâ€™re going to be able to put this knowledge into practice, namely:
- How to discover theÂ command injectionÂ vulnerability
- How to test and exploit this vulnerability using payloads designed for different operating systems
- How to prevent this vulnerability in an application
- Lastly, youâ€™ll get to apply theory into practice learning in a practical at the end of the room.
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€» ADDED NOTES â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
<br>
</div>

==DEF-Command injection is a type of **security vulnerability** that happens when an application allows a malicious user to run system-level commands on the host machine by manipulating input fields or parameters.==

ğŸ‘‰ In simpler terms:  
If a program takes user input and passes it directly to the operating system (OS) shell without proper validation or sanitization, an attacker can "inject" extra commands. This lets them trick the system into executing unintended actions.
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€» ADDED NOTES â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
<br>
</div>
To begin with, letâ€™s first understand whatÂ command injectionÂ is.Â Command injectionÂ is the abuse of an application's behaviour to execute commands on the operating system, using the same privileges that the application on a device is running with. For example, achievingÂ command injectionÂ on a web server running as a user namedÂ `joe`Â will execute commands under thisÂ `joe`Â user - and therefore obtain any permissions thatÂ `joe`Â has.

==Command injectionÂ is also often known as â€œRemote Code Executionâ€ (RCE)== because of the ability to remotely execute code within an application. These vulnerabilities are often the most lucrative to an attacker because it means that the attacker can directly interact with the vulnerable system. For example, an attacker may read system or user files, data, and things of that nature.  

For example, being able to abuse an application to perform the commandÂ `whoami`Â to list what user account the application is running will be an example ofÂ command injection.

Command injectionÂ was one of the top ten vulnerabilities reported by Contrast Securityâ€™s AppSec intelligence report in 2019. ([Contrast Security AppSec., 2019](https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report)). Moreover, theÂ OWASPÂ framework constantly proposes vulnerabilities of this nature as one of the top ten vulnerabilities of a web application ([OWASPÂ framework](https://owasp.org/www-project-top-ten/)).
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>

## 2. Discovering Command Injection
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>

## 3. Exploiting Command Injection

This vulnerability exists because applications often use functions in programming languages such asÂ PHP, Python and NodeJS to pass data to and to make system calls on the machineâ€™s operating system. For example, taking input from a field and searching for an entry into a file. Take this code snippet below as an example:

In this code snippet, the application takes data that a user enters in an input field namedÂ `$title`Â to search a directory for a song title. Letâ€™s break this down into a few simple steps.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/a54a09f7c4efa1d340ab678ece230c44.png)  

**1.**Â The application stores MP3 files in a directory contained on the operating system.

**2.**Â The user inputs the song title they wish to search for. The application stores this input into theÂ `$title`Â variable.

**3.**Â The data within thisÂ `$title`Â variable is passed to the commandÂ `grep`Â to search a text file namedÂ _songtitle.__txt_Â for the entry of whatever the user wishes to search for.

**4.**Â The output of this search ofÂ _songtitle.__txt_Â will determine whether the application informs the user that the song exists or not.

Now, this sort of information would typically be stored in a database; however, this is just an example of where an application takes input from a user to interact with the applicationâ€™s operating system.

An attacker could abuse this application by injecting their own commands for the application to execute. Rather than usingÂ `grep`Â to search for an entry inÂ `songtitle.txt`, they could ask the application to read data from a more sensitive file.

Abusing applications in this way can be possible no matter the programming language the application uses. As long as the application processes and executes it, it can result inÂ command injection. For example, this code snippet below is an application written in Python.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/04a1cb87fad0a9b47761afddc48e0bf2.png)  

Note, you are not expected to understand the syntax behind these applications. However, for the sake of reason, I have outlined the steps of how this Python application works as well.

1. The "flask" package is used to set up a web server
2. A function that uses the "subprocess" package to execute a command on the device
3. We use a route in the webserver that will execute whatever is provided. For example, to executeÂ `whoami`, we'd need to visitÂ http://flaskapp.thm/whoami
<div>
<br>
<br>
</div>

### Questions

##### 
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>

## 4. Remediating Command Injection
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>

## 5. Practical: Command Injection (Deploy)
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>

## 6. Conclusion
<div align="center">
<br>
<br>
â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»â€»
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>

## References

https://tryhackme.com/room/oscommandinjection