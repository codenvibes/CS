
# Nessus Scan

---

A new Nessus scan can be configured by clicking `New Scan`, and selecting a scan type. Scan templates fall into three categories: `Discovery`, `Vulnerabilities`, and `Compliance`.

**Note:** The scans shown in this section have already been pre-run to save you the time of waiting for them to finish. If you re-run the scan, it's best to go through vulnerabilities as they come, instead of waiting for the scan to finish, as they can take 1-2 hours to finish.

---

## New Scan

Here we have options for a basic `Host Discovery` scan to identify live hosts/open ports or a variety of scan types such as the `Basic Network Scan`, `Advanced Scan`, `Malware Scan`, `Web Application Tests`, as well as scans targeted at specific CVEs and audit & compliance standards. A description of each scan type can be found [here](https://docs.tenable.com/nessus/Content/ScanAndPolicyTemplates.htm).

![Scan Templates page showing options: Host Discovery, Basic Network Scan, Advanced Scan, Advanced Dynamic Scan, Malware Scan, Mobile Device Scan, Web Application Tests, Credentialed Patch Audit, Badlock Detection, Bash Shellshock Detection, DROWN Detection.](https://academy.hackthebox.com/storage/modules/108/nessus/nessus_scan_types.png)

For the purposes of this exercise, we will choose the `Basic Network Scan` option, and we can enter our targets: ![Nessus settings page: Name is Windows_basic, Folder is My Scans, Target is 172.16.16.100.](https://academy.hackthebox.com/storage/modules/108/nessus/general.png)

**Note:** For this module, the Windows target will be `172.16.16.100` and the Linux target will be `172.16.16.160`.

---

## Discovery

In the `Discovery` section, under `Host Discovery`, we're presented with the option to enable scanning for fragile devices. Scanning devices such as network printers often result in them printing out reams of paper with garbage text, leaving the devices unusable. We can leave this setting disabled: ![Options for Fragile Devices: Scan Network Printers, Scan Novell Netware hosts, Scan Operational Technology devices.](https://academy.hackthebox.com/storage/modules/108/nessus/options.png)

In `Port Scanning`, we can choose whether to scan common ports, all ports, or a self-defined range, depending on our requirements: ![Nessus scan settings: Port scan (common ports) selected. General settings include testing local Nessus host and fast network discovery. Port scanner settings include scanning common ports, using netstat if credentials are provided, and using SYN scanner if necessary. Ping hosts using TCP, ARP, ICMP (2 retries).](https://academy.hackthebox.com/storage/modules/108/nessus/discovery.png)

Within the `Service Discovery` subsection, the `Probe all ports to find services` option is selected by default. It's possible that a poorly designed application or service could crash as a result of this probing, but most applications should be robust enough to handle this. Searching for SSL/TLS services is also enabled by default on a custom scan, and Nessus can additionally be instructed to identify expiring and revoked certificates.

---

## Assessment

Under the `Assessment` category, web application scanning can also be enabled if required, and a custom user agent and various other web application scanning options can be specified (e.g., a URL for Remote File Inclusion (RFI) testing): ![Web Application Settings: Scan web applications is on. General Settings use a custom User-Agent 'Mozilla/4.0'. Web Crawler starts from '/' and excludes '/server_privileges.php|logout'.](https://academy.hackthebox.com/storage/modules/108/nessus/webapp.png)

If desired, Nessus can attempt to authenticate against discovered applications and services using provided credentials (if running a credentialed scan), or else can perform a brute-force attack with the provided username and password lists: ![Settings options: General Settings to use only user-provided credentials, Oracle Database to test default accounts, and Hydra to always enable for brute force attacks.](https://academy.hackthebox.com/storage/modules/108/nessus/hydra.png)

User enumeration can also be performed using various techniques, such as RID Brute Forcing: ![Settings panel showing options for user enumeration methods: SAM Registry, ADSI Query, and WMI Query are checked. RID Brute Forcing is off. General setting for requesting SMB Domain information is unchecked.](https://academy.hackthebox.com/storage/modules/108/nessus/userenum.png)

If we opt to perform RID Brute Forcing, we can set the starting and ending UIDs for both domain and local user accounts: ![RID Brute Forcing enabled. Enumerate Domain Users and Local Users with Start UID 1000 and End UID 1200.](https://academy.hackthebox.com/storage/modules/108/nessus/ridbf.png)

---

## Advanced

On the `Advanced` tab, safe checks are enabled by default. This prevents Nessus from running checks that may negatively impact the target device or network. We can also choose to slow or throttle the scan if Nessus detects any network congestion, stop attempting to scan any hosts that become unresponsive, and even choose to have Nessus scan our target IP list in random order: ![Settings panel with 'Enable safe checks' checked. Options to stop scanning unresponsive hosts and scan IPs randomly are unchecked. Performance options include network timeout set to 5 seconds, max 4 checks per host, and 30 hosts per scan.](https://academy.hackthebox.com/storage/modules/108/nessus/advanced.png)

---

## References

