
## 1. What is the Purpose of Malware Analysis?

==**DEF-Malware analysis** is the process of examining malicious software to understand its behavior, purpose, and how it can be detected or removed.==

When analysing malware, it is important to consider the following:

- Point of Entry (PoE) i.e. Was it through spam that our e-mail filtering missed and the user opened the attachment? Let's review our spam filters and train our users better for future prevention!

- What are the indicators that malware has even been executed on a machine? Are there any files, processes, or perhaps any attempt of "un-ordinary" communication?

- How does the malware perform? Does it attempt to infect other devices? Does it encrypt files or install anything like a backdoor / Remote Access Tool (RAT)?

- Most importantly - can we ultimately prevent and/or detect further infection?!
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 2. Understanding Malware Campaigns

Despite the many variants of malware, attacks can generally be classified into two types:¬†**Targeted**¬†and¬†**Mass¬†Campaign**.  

### Targeted

A "Targeted" attack is just that - targeted. In most cases, malware attacks that occur this way are created for a specific purpose against a specific target. A great example of this type of purpose could be the¬†[DarkHotel](https://www.kaspersky.co.uk/resource-center/threats/darkhotel-malware-virus-threat-definition)¬†malware, whom is designed to steal information such as authentication details from government officials.

### Mass Campaign

On the other hand, the "Mass Campaign" classification can be akin to many real life examples, and is the most common type of attacks. The entire purpose of this type of Malware is to infect as many devices as possible and perform whatever it may - regardless of target.

Companies such as Kaspersky to name one, track these campaigns (known as Advanced Persistent Threats (APTs) and often report on their infection rate and indicators, much akin to the real-life spread of a virus from the World Health Organisation (WHO).¬†

> **APTs vs Regular Malware**
> 
> **Think of it this way:**  
> - Regular malware is like a **smash-and-grab robbery** ‚Äî fast, loud, and meant to cause immediate damage.
> - **APTs** are like a **spy living in your house**, quietly gathering secrets over time while avoiding detection.

Kaspersky¬†[report on the "Crouching Yeti (Energetic Bear)" campaign](https://www.kaspersky.co.uk/resource-center/threats/crouching-yeti-energetic-bear-malware-threat), this campaign specifically targets the following:

- Industrial/machinery
- Manufacturing
- Pharmaceutical
- Construction
- Education
- Information technology

(Kaspersky)

### Questions

![[Pasted image 20250729165139.png]]

> **Stuxnet**
> - A highly sophisticated malware discovered in 2010
> - **Target**: Iran‚Äôs nuclear facilities, specifically the **centrifuges at Natanz**
> - **Method**: It attacked industrial control systems (SCADA), manipulating hardware while showing false normal readings
> - **Believed Origin**: Joint operation by the **U.S. and Israel** (though never officially confirmed)
> - **Impact**: Physically damaged uranium enrichment centrifuges and set back Iran‚Äôs nuclear program


![[Pasted image 20250729165218.png]]

> **WannaCry Ransomware**
> 
> - **Exploit Used**: **EternalBlue** ‚Äî a Windows SMBv1 vulnerability (CVE-2017-0144)
> - **Spread**: Rapidly across the globe in **May 2017**
> - **Type**: **Mass Campaign Attack** ‚Äî not targeted, affected individuals and organizations worldwide
> - **Impact**: Infected over 200,000 systems in more than 150 countries
> - **Notable Victims**: NHS (UK), FedEx, Telef√≥nica
> 
> EternalBlue was a **stolen NSA exploit**, later leaked by a group called the **Shadow Brokers**.
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 3. Identifying if a Malware Attack has Happened

Malware typically leaves behind noticeable traces on a system, making it easier for analysts to investigate, even if the activity seems minimal at first.

The ultimate process of a malware attack can be broken down into a few broad steps:
1. Delivery
2. Execution
3. Maintaining¬†persistence¬†(not always the case!)
4. Propagation (not always!)

**These steps will generate lots of data.**¬†Namely: network traffic such as communicating with hosts,¬†file system¬†interaction like read/writes and modification.

Malware is essentially classified based upon the behaviours it produces to perform the steps listed above.¬†For a famous example, Wannacry performs all four of these steps.

### 1.¬†Delivery

This could be of many methods, to name a few: USB (Stuxnet!), PDF attachments through "Phishing" campaigns or vulnerability enumeration.

### 2.¬†Execution

Here's the main part of how we classify Malware. What does it actually do? If it encrypts files - it's Ransomware! If it records information like¬†keystrokes¬†or displays adware - we can classify it as Spyware.

**We only understand this stage through analysing the sample, which is why analysis is important.**

### 3.¬†Maintaining¬†Persistence

It wouldn't make much sense for Malware authors to go through all the trouble of developing a piece of code that is capable of execution - just for it to execute and that's it...Gone. Unless you have a very specific agenda ([Cerber](https://blog.malwarebytes.com/detections/ransom-cerber/)).

I have submitted an extensive report on this specific Malware, amongst others for a University Module on Malware Analysis...however I will wait for it to be marked before sharing.¬†

Imagine a¬†keylogger¬†has been installed, but you then restart your Computer 30 seconds later. Unless you've entered a lot of sensitive information in 30 seconds - that'll be of no use to the author.

### 4.¬†Persistence

This stage is largely why Malware is so¬†**"noisy"**, Malware employs many techniques, of which we'll be covering in-depth much later on. Essentially, this stage is just to make sure that the "execution" is worth its while.

### 5.¬†Propagation

Hey...If you can infect one device, why not infect more whilst you're at it? Again, this is another reason why Malware can be so noticeable. Host discovery generates a lot of network traffic, we'll come to this later.
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
<br>
</div>

> A **signature** is like a digital fingerprint ‚Äî it's a clue or evidence that shows malware was (or still is) present on a computer system.

**In Summary, there are two categories of fingerprints that malware may leave behind on a Host after an attack:**

### Host-Based Signatures

> Clues left **on the infected computer itself** (the "host").

Think of these as **physical traces** the malware leaves on the computer:
- üîê **Was a file encrypted?** (like in a ransomware attack)
- üõ†Ô∏è **Did it install new programs or tools?**
- üìù **Did it create new files, registry keys, or change system settings?**
- üìÇ **Did it try to stay permanently on the system (persistence)?**

### Network-Based Signatures

> Clues seen from **network traffic** (i.e., what the malware is doing online).

Think of this as **catching malware by watching what it says or does over the internet or local network**:
- üåç **Is the malware trying to contact a remote server?** (e.g., to get commands or send stolen data)
- üí∞ **Did it try to ask for Bitcoin payments?** (like ransomware often does)
- üì° **Is it using suspicious protocols** (like "Samba" in the Wannacry attack)?
- üîÑ **Is it spreading to other machines on the network?**

### Questions

![[Pasted image 20250729173946.png]]
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 4. Static Vs. Dynamic Analysis
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 5. Discussion of Provided Tools & Their Uses
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 6. Connecting to the Windows Analysis Environment (Deploy)
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 7. Obtaining MD5 Checksums of Provided Files
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 8. Now lets see if the MD5 Checksums have been analyzed before
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 9. Identifying if the Executables are obfuscated / packed
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 10. What is Obfuscation / Packing?
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 11. Visualizing the Differences Between Packed & Non-Packed Code
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 12. Introduction to Strings
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 13. Introduction to Imports
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


## 14. Practical Summary
<div align="center">
<br>
<br>
‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª‚Äª
<br>
</div>
<!-- PAGE BREAK -->
<div style="page-break-after: always;"></div>


---

## References

https://tryhackme.com/room/malmalintroductory